(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3326],{87475:(e,a,s)=>{Promise.resolve().then(s.bind(s,68883))},68883:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>j});var t=s(95155),i=s(12115),n=s(76046),l=s(6327),c=s(6748),r=s(13612),d=s(71119),o=s(96351),m=s(69155),x=s(98969),h=s(78069),u=s(89208),p=s(8077),g=s(38258);let f=[{id:"introduction",label:"Basic Intro"},{id:"basic",label:"Basic Information"},{id:"packages",label:"Popular Destination"},{id:"description",label:"Destination Description"},{id:"review",label:"Review"}];function j(){let e=(0,n.useRouter)(),{showSuccess:a,showError:s,showInfo:j,showWarning:b}=(0,p.h)(),{setLoading:y,isLoading:N,showGlobalLoading:v,hideGlobalLoading:w}=(0,g.M)(),[k,T]=(0,i.useState)("introduction"),[D,C]=(0,i.useState)([]),[S,P]=(0,i.useState)([]),[A,M]=(0,i.useState)(!1),[E,I]=(0,i.useState)({type:"",message:""}),[L,O]=(0,i.useState)([]),[q,H]=(0,i.useState)({metaTitle:"",metaTags:"",extraMetaTags:"",category:"",fromDestination:"",destinationName:"",country:"India",destinationHeading:"",images:[],urlSlug:"",description:"",destinationImage:[],popularPackages:[],mainPackages:[],detailedDescription:"",faqs:[{question:"",answer:""}]}),_=(0,i.useRef)(null),R=()=>{_.current&&_.current.scrollIntoView({behavior:"smooth",block:"start"})},F=async()=>{try{let e=await fetch("https://data.tripknock.in/theme/all"),a=await e.json();a&&Array.isArray(a)&&O(a)}catch(e){console.log("Error fetching themes:",e)}};(0,i.useEffect)(()=>{document.title="Create Theme Page - Tripknock",y("fetchData",!0,"Loading data..."),(async()=>{try{let a=[{value:"Kashmir Valley Tour",label:"Kashmir Valley Tour"},{value:"Gulmarg Skiing Adventure",label:"Gulmarg Skiing Adventure"},{value:"Ladakh Explorer",label:"Ladakh Explorer"},{value:"Kerala Backwaters",label:"Kerala Backwaters"},{value:"Rajasthan Heritage Tour",label:"Rajasthan Heritage Tour"}];async function e(){let e=await fetch("https://data.tripknock.in/themes-pages/load"),s=await e.json();if(s.destinations){let e=[];s.destinations.map(a=>e.push({value:a.slug,label:a.name})),C(e)}s.packages&&(a=[],s.packages.map(e=>a.push({value:e.slug,label:e.title})),P(a))}await e()}catch(e){console.log("Error fetching tours:",e),s("Failed to load data")}finally{y("fetchData",!1)}})(),F()},[]);let J=async e=>{let a=await fetch("https://data.tripknock.in/themes-pages/get-packages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:e})}),s=await a.json();if(!0===s.status){let e=[];s.data.map(a=>e.push({value:a.slug,label:a.title})),P(e)}},B=async(e,a)=>{let t=await fetch("https://data.tripknock.in/themes-pages/validate-theme",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:e,category:a})});!1===(await t.json()).status&&s("Theme page already exists")};async function K(e){if(""===e)return!1;let a=await fetch("https://data.tripknock.in/themes-pages/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:e})});!1===(await a.json()).status&&s("Slug already exist")}let Q=e=>{let{name:a,value:s}=e.target;if("category"===a&&(J(s),B(q.fromDestination,s)),"fromDestination"===a&&B(s,q.category),"urlSlug"===a){H(e=>({...e,urlSlug:s.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")})),K(s.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""));return}if("destinationHeading"===a){H(e=>({...e,destinationHeading:s})),H(e=>({...e,urlSlug:s.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")})),K(s.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""));return}H(e=>({...e,[a]:s}))},U=(e,a,s)=>{H(t=>({...t,faqs:t.faqs.map((t,i)=>i===e?{...t,[a]:s}:t)}))},V=e=>{H(a=>({...a,faqs:a.faqs.filter((a,s)=>s!==e)}))},z=async t=>{if(v("Creating theme page..."),""===q.title){T("basic"),s("Please fill Destination Heading"),w();return}if(""===q.description){T("basic"),s("Please fill Description"),w();return}if(q.images.length>3||0===q.images.length){T("basic"),s("Please check images"),w();return}try{let i=new FormData,n={};n.status=t,n.meta=JSON.stringify({title:q.metaTitle||"",tags:q.metaTags||"",extraTags:q.extraMetaTags||""}),n.fromDestination=q.fromDestination||"",n.name=q.destinationHeading||"",n.category=q.category||"",n.title=q.destinationHeading||"",n.slug=q.urlSlug||"",n.description=q.description||"",n.popularDestinations=q.popularPackages||[],n.mainPackages=q.mainPackages||[],n.longDescription=q.detailedDescription||"",n.faqs=JSON.stringify(q.faqs||[]),i.append("data",JSON.stringify(n)),q.images.forEach(e=>{i.append("images",e)});let l=await fetch("https://data.tripknock.in/themes-pages/create",{method:"POST",headers:{admin:JSON.parse(u.A.get("tk_auth_details")).email},body:i});l=await l.json(),!0===l.status?(a("Theme page created successfully!"),setTimeout(()=>{e.push("/themes")},1500)):s(l.message||"Failed to create theme page")}catch(e){console.log("Error creating destination:",e),s("An error occurred while creating theme page")}finally{w()}};return(0,t.jsxs)("div",{ref:_,className:"container mx-auto px-4 py-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-secondary-900",children:"Create Theme Page"}),(0,t.jsx)("p",{className:"text-secondary-600",children:"Add a new theme page"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:()=>e.back(),className:"btn-secondary flex items-center gap-2",children:[(0,t.jsx)(l.A,{className:"w-5 h-5"}),"Cancel"]}),(0,t.jsxs)("button",{onClick:()=>z("draft"),disabled:N("fetchData")||!1,className:"btn-secondary flex items-center gap-2",children:[(0,t.jsx)(c.A,{className:"w-5 h-5"}),"Save Draft"]}),(0,t.jsxs)("button",{onClick:()=>z("published"),disabled:N("fetchData")||!1,className:"btn-primary flex items-center gap-2",children:[(0,t.jsx)(r.A,{className:"w-5 h-5"}),"Publish"]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-secondary-200",children:[(0,t.jsx)("div",{className:"border-b border-secondary-200",children:(0,t.jsx)("div",{className:"flex",children:f.map(e=>(0,t.jsx)("button",{onClick:()=>T(e.id),className:"px-6 py-3 text-sm font-medium focus:outline-none ".concat(k===e.id?"border-b-2 border-primary-500 text-primary-600":"text-secondary-500 hover:text-secondary-700"),children:e.label},e.id))})}),(0,t.jsxs)("div",{className:"p-6",children:["introduction"===k&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Theme/Category"}),(0,t.jsxs)("select",{name:"category",value:q.category,onChange:Q,className:"input-field w-full",children:[(0,t.jsx)("option",{value:"",children:"Select Theme/Category"}),L.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"From Location"}),(0,t.jsx)("input",{type:"text",name:"fromDestination",value:q.fromDestination,onChange:Q,className:"input-field w-full",placeholder:"Enter From Location"})]})]}),(0,t.jsx)("div",{className:"mt-8 border-t-2 pt-8 flex justify-end gap-4",children:(0,t.jsxs)("button",{onClick:()=>{R(),T("basic")},disabled:N("fetchData"),className:"btn-primary flex items-center gap-2",children:["Next Tab",(0,t.jsx)(m.A,{className:"w-5 h-5"})]})})]}),"basic"===k&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Destination Heading"}),(0,t.jsx)("input",{type:"text",name:"destinationHeading",value:q.destinationHeading,onChange:Q,className:"input-field w-full",placeholder:"Enter destination heading"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"URL Slug"}),(0,t.jsx)("input",{type:"text",name:"urlSlug",value:q.urlSlug,className:"input-field w-full",onChange:Q})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Destination Image"}),(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-4",children:[(0,t.jsxs)("label",{className:"flex items-center justify-center w-64 h-40 px-4 transition bg-white border-2 border-secondary-300 border-dashed rounded-md appearance-none cursor-pointer hover:border-secondary-400 focus:outline-none",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,t.jsx)(d.A,{className:"w-8 h-8 text-secondary-400"}),(0,t.jsx)("span",{className:"text-sm text-secondary-500",children:"Click to upload image"})]}),(0,t.jsx)("input",{type:"file",name:"destinationImage",accept:"image/*",className:"hidden",multiple:!0,onChange:e=>{let a=Array.from(e.target.files),s=a.map(e=>URL.createObjectURL(e));H(e=>({...e,images:[...e.images,...a],destinationImage:[...e.destinationImage,...s]}))}})]}),q.destinationImage&&q.destinationImage.length>0&&q.destinationImage.map((e,a)=>(0,t.jsxs)("div",{className:"relative w-64 h-40",children:[(0,t.jsx)("img",{src:e,alt:"Destination preview",className:"w-full h-full object-cover rounded-md"}),(0,t.jsx)("button",{onClick:()=>{H(e=>({...e,images:e.images.filter((e,s)=>s!==a),destinationImage:e.destinationImage.filter((e,s)=>s!==a)}))},className:"absolute top-2 right-2 p-1 bg-white rounded-full shadow-sm hover:bg-secondary-100",children:(0,t.jsx)(l.A,{className:"w-4 h-4 text-secondary-600"})})]},a))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Description"}),(0,t.jsx)(x.default,{value:q.description,onChange:e=>H(a=>({...a,description:e}))})]}),(0,t.jsxs)("div",{className:"mt-6 border border-secondary-200 rounded-lg",children:[(0,t.jsxs)("button",{type:"button",className:"w-full px-4 py-3 flex items-center justify-between text-left text-sm font-medium text-secondary-700 hover:bg-secondary-50 focus:outline-none",onClick:()=>M(!A),children:[(0,t.jsx)("span",{children:"Advanced SEO Options (Optional)"}),(0,t.jsx)("svg",{className:"h-5 w-5 text-secondary-500 transform ".concat(A?"rotate-180":""," transition-transform duration-200"),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),A&&(0,t.jsxs)("div",{className:"px-4 py-3 border-t border-secondary-200 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Meta Title"}),(0,t.jsx)("input",{type:"text",name:"metaTitle",className:"input-field w-full",value:q.metaTitle,onChange:Q,placeholder:"Enter meta title"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Meta Description"}),(0,t.jsx)("input",{type:"text",name:"metaTags",className:"input-field w-full",value:q.metaTags,onChange:Q,placeholder:"Enter meta description for SEO"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Additional Meta Tags"}),(0,t.jsx)("textarea",{name:"extraMetaTags",className:"input-field w-full h-24 resize-none",value:q.extraMetaTags,onChange:Q,placeholder:"Enter additional meta tags"})]})]})]}),(0,t.jsxs)("div",{className:"mt-8 border-t-2 pt-8 flex justify-end gap-4",children:[(0,t.jsxs)("button",{onClick:()=>{R(),T("introduction")},disabled:N("fetchData"),className:"btn-secondary flex items-center gap-2",children:[(0,t.jsx)(o.A,{className:"w-5 h-5"}),"Previous Tab"]}),(0,t.jsxs)("button",{onClick:()=>{R(),T("packages")},disabled:N("fetchData"),className:"btn-primary flex items-center gap-2",children:["Next Tab",(0,t.jsx)(m.A,{className:"w-5 h-5"})]})]})]}),"packages"===k&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Popular Destination"}),(0,t.jsx)(h.Ay,{isMulti:!0,name:"popularPackages",options:D,value:D.filter(e=>q.popularPackages.includes(e.value)),onChange:e=>{H(a=>({...a,popularPackages:e?e.map(e=>e.value):[]}))},className:"w-full",classNamePrefix:"select",placeholder:"Search and select popular destinations..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Main Packages"}),(0,t.jsx)(h.Ay,{isMulti:!0,name:"mainPackages",options:S,value:S.filter(e=>q.mainPackages.includes(e.value)),onChange:e=>{H(a=>({...a,mainPackages:e?e.map(e=>e.value):[]}))},className:"w-full",classNamePrefix:"select",placeholder:"Search and select tours..."})]}),(0,t.jsxs)("div",{className:"mt-8 border-t-2 pt-8 flex justify-end gap-4",children:[(0,t.jsxs)("button",{onClick:()=>{R(),T("basic")},disabled:N("fetchData"),className:"btn-secondary flex items-center gap-2",children:[(0,t.jsx)(o.A,{className:"w-5 h-5"}),"Previous Tab"]}),(0,t.jsxs)("button",{onClick:()=>{R(),T("description")},disabled:N("fetchData"),className:"btn-primary flex items-center gap-2",children:["Next Tab",(0,t.jsx)(m.A,{className:"w-5 h-5"})]})]})]}),"description"===k&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Destination in Detail"}),(0,t.jsx)(x.default,{value:q.detailedDescription,onChange:e=>H(a=>({...a,detailedDescription:e}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,t.jsx)("label",{className:"block text-sm font-medium text-secondary-700",children:"FAQs"})}),(0,t.jsxs)("div",{className:"space-y-4",children:[q.faqs.map((e,a)=>(0,t.jsxs)("div",{className:"p-4 border border-secondary-200 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,t.jsxs)("h3",{className:"text-sm font-medium",children:["FAQ #",a+1]}),(0,t.jsx)("button",{type:"button",onClick:()=>V(a),className:"text-red-600 hover:text-red-800",children:(0,t.jsx)(l.A,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{children:(0,t.jsx)("input",{type:"text",value:e.question,onChange:e=>U(a,"question",e.target.value),className:"input-field w-full",placeholder:"Enter question"})}),(0,t.jsx)("div",{children:(0,t.jsx)(x.default,{value:e.answer,onChange:e=>U(a,"answer",e)})})]})]},a)),(0,t.jsx)("button",{type:"button",onClick:()=>{H(e=>({...e,faqs:[...e.faqs,{question:"",answer:""}]}))},className:"btn-secondary text-sm",children:"Add FAQ"})]})]}),(0,t.jsxs)("div",{className:"mt-8 border-t-2 pt-8 flex justify-end gap-4",children:[(0,t.jsxs)("button",{onClick:()=>{R(),T("packages")},disabled:N("fetchData"),className:"btn-secondary flex items-center gap-2",children:[(0,t.jsx)(o.A,{className:"w-5 h-5"}),"Previous Tab"]}),(0,t.jsxs)("button",{onClick:()=>{R(),T("review")},disabled:N("fetchData"),className:"btn-primary flex items-center gap-2",children:["Next Tab",(0,t.jsx)(m.A,{className:"w-5 h-5"})]})]})]}),"review"===k&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Basic Information"}),(0,t.jsxs)("dl",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-secondary-500",children:"From Location"}),(0,t.jsx)("dd",{className:"text-sm text-secondary-900",children:q.fromDestination})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-secondary-500",children:"Theme/Category"}),(0,t.jsx)("dd",{className:"text-sm text-secondary-900",children:q.category})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-secondary-500",children:"Destination Heading"}),(0,t.jsx)("dd",{className:"text-sm text-secondary-900",children:q.destinationHeading})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-secondary-500",children:"URL Slug"}),(0,t.jsx)("dd",{className:"text-sm text-secondary-900",children:q.urlSlug})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Description"}),(0,t.jsx)("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:q.description}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Seo Tags"}),(0,t.jsxs)("dl",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-secondary-500",children:"Meta Title"}),(0,t.jsx)("dd",{className:"text-sm text-secondary-900",children:q.metaTitle||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-secondary-500",children:"Meta Description"}),(0,t.jsx)("dd",{className:"text-sm text-secondary-900",children:q.metaTags||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-secondary-500",children:"Additional Meta Tags"}),(0,t.jsx)("dd",{className:"text-sm text-secondary-900",children:q.extraMetaTags||"-"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Popular Destination"}),(0,t.jsx)("dl",{className:"space-y-2",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:q.popularPackages.map((e,a)=>(0,t.jsx)("span",{className:"px-2 py-1 bg-secondary-100 text-secondary-700 rounded",children:e},a))})}),(0,t.jsx)("h3",{className:"text-lg font-medium mt-5 mb-4",children:"Main Packages"}),(0,t.jsx)("dl",{className:"space-y-2",children:(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:q.mainPackages.map((e,a)=>(0,t.jsx)("span",{className:"px-2 py-1 bg-secondary-100 text-secondary-700 rounded",children:e},a))})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Destination in Detail"}),(0,t.jsx)("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:q.detailedDescription}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-4",children:"FAQs"}),(0,t.jsx)("div",{className:"space-y-4",children:q.faqs.map((e,a)=>(0,t.jsxs)("div",{className:"border-b border-secondary-200 pb-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-2",children:e.question}),(0,t.jsx)("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.answer}})]},a))})]}),(0,t.jsxs)("div",{className:"mt-8 flex justify-end gap-4",children:[(0,t.jsxs)("button",{onClick:()=>{R(),T("description")},disabled:N("fetchData"),className:"btn-secondary flex items-center gap-2",children:[(0,t.jsx)(o.A,{className:"w-5 h-5"}),"Previous Tab"]}),(0,t.jsxs)("button",{onClick:()=>z("draft"),disabled:N("fetchData"),className:"btn-secondary flex items-center gap-2",children:[(0,t.jsx)(c.A,{className:"w-5 h-5"}),"Save Draft"]}),(0,t.jsxs)("button",{onClick:()=>z("published"),disabled:N("fetchData"),className:"btn-primary flex items-center gap-2",children:[(0,t.jsx)(r.A,{className:"w-5 h-5"}),"Publish"]})]})]})]})]})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[2983,401,4905,450,2624,8441,1517,7358],()=>a(87475)),_N_E=e.O()}]);