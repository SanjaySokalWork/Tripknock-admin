(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5009],{35804:(e,t,s)=>{Promise.resolve().then(s.bind(s,61054))},36228:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(95155),r=s(97908);function n(){return(0,a.jsx)(r.A,{})}},61054:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var a=s(95155),r=s(12115),n=s(77740),l=s(79545),o=s(450),i=s(6327),c=s(6748),d=s(83476),m=s(36417),u=s(27753),h=s(26214),x=s(78477),f=s(89208),p=s(36228),b=s(8077),g=s(38258);function j(){let{showSuccess:e,showError:t,showInfo:s,showWarning:j,testNotification:y}=(0,b.h)(),{setLoading:w,isLoading:v}=(0,g.M)(),[N,k]=(0,r.useState)([]),[C,A]=(0,r.useState)(!1),[E,U]=(0,r.useState)(null),[S,P]=(0,r.useState)(null),[T,L]=(0,r.useState)(0),[F,z]=(0,r.useState)({name:"",email:"",role:"blogger",phone:"",password:""}),[O,q]=(0,r.useState)(null);(0,r.useEffect)(()=>{document.title="Users - Admin Panel",w("fetchUsers",!0,"Loading users..."),async function(){try{let e=JSON.parse(f.A.get("tk_auth_details")).email;q(e);let t=await fetch("https://data.tripknock.in/user/all",{method:"GET",headers:{"Content-Type":"application/json",admin:e}});if(!t.ok)throw Error("Failed to fetch users: ".concat(t.status," ").concat(t.statusText));let s=await t.json();if(s&&Array.isArray(s))k(s);else throw Error("Invalid data format received from server")}catch(e){console.error("Error fetching users:",e),t("Failed to load users: ".concat(e.message)),k([])}finally{w("fetchUsers",!1)}}()},[T]);let D=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e?(U(e),z({name:e.name,email:e.email,role:e.role,phone:e.phone,password:""})):(U(null),z({name:"",email:"",role:"blogger",phone:"",password:""})),A(!0)},I=()=>{A(!1),U(null)},_=async()=>{if(S){w("deleteUser",!0,"Deleting user: ".concat(S.name,"..."));try{let t=await fetch("https://data.tripknock.in/user/delete",{method:"POST",headers:{"Content-Type":"application/json",admin:O},body:JSON.stringify({id:S.id})});if(!t.ok)throw Error("Failed to delete user: ".concat(t.status," ").concat(t.statusText));let s=await t.json();if(!0===s.status)e('User "'.concat(S.name,'" has been successfully deleted')),L(T+1);else throw Error(s.message||"Failed to delete user")}catch(e){console.error("Error deleting user:",e),t('Failed to delete user "'.concat(S.name,'": ').concat(e.message))}finally{w("deleteUser",!1),P(null)}}},B=e=>{let{name:t,value:s}=e.target;if("email"===t&&E){j("Email cannot be changed for existing users");return}z(e=>({...e,[t]:s}))},J=()=>F.name.trim()?F.email.trim()?F.phone.trim()?E||F.password.trim()?!F.password||!(F.password.length<6)||(t("Password must be at least 6 characters long"),!1):(t("Password is required for new users"),!1):(t("Phone number is required"),!1):(t("Email is required"),!1):(t("Name is required"),!1),G=async s=>{if(s.preventDefault(),!J())return;let a=E?"Updating":"Creating",r=E?E.name:F.name;w("saveUser",!0,"".concat(a," user: ").concat(r,"..."));try{if(null!==E){let t=await fetch("https://data.tripknock.in/user/update",{method:"POST",headers:{"Content-Type":"application/json",admin:O},body:JSON.stringify({name:F.name,phone:F.phone,email:F.email,role:F.role,id:E.id,password:F.password.trim()})});if(!t.ok)throw Error("Failed to update user: ".concat(t.status," ").concat(t.statusText));let s=await t.json();if(!0===s.status)e('User "'.concat(F.name,'" has been successfully updated')),L(T+1);else throw Error(s.message||"Failed to update user")}else{let t=await fetch("https://data.tripknock.in/user/add",{method:"POST",headers:{"Content-Type":"application/json",admin:O},body:JSON.stringify(F)});if(!t.ok)throw Error("Failed to create user: ".concat(t.status," ").concat(t.statusText));let s=await t.json();if(!0===s.status)e('User "'.concat(F.name,'" has been successfully created with role "').concat(F.role,'"')),L(T+1);else throw Error(s.message||"Failed to create user")}}catch(s){console.error("Error saving user:",s);let e=E?"updating":"creating";t("Failed to ".concat(e,' user "').concat(F.name,'": ').concat(s.message))}finally{w("saveUser",!1),z({name:"",email:"",role:"blogger",phone:"",password:""}),I()}},M=e=>{P(e),j("Preparing to delete user: ".concat(e.name))};return v("fetchUsers")?(0,a.jsx)(p.A,{}):(0,a.jsx)(a.Fragment,{children:v("saveUser")||v("deleteUser")?(0,a.jsx)(p.A,{}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-secondary-900",children:"Users"}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)("button",{onClick:()=>D(),className:"btn-primary flex items-center gap-2",children:[(0,a.jsx)(n.A,{})," Add User"]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-4 text-secondary-600",children:"Name"}),(0,a.jsx)("th",{className:"text-left p-4 text-secondary-600",children:"Email"}),(0,a.jsx)("th",{className:"text-left p-4 text-secondary-600",children:"Role"}),(0,a.jsx)("th",{className:"text-left p-4 text-secondary-600",children:"Phone"}),(0,a.jsx)("th",{className:"text-right p-4 text-secondary-600",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:N.map(e=>e.email!==O&&(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"p-4 text-secondary-900",children:e.name}),(0,a.jsx)("td",{className:"p-4 text-secondary-600",children:e.email}),(0,a.jsx)("td",{className:"p-4 text-secondary-600",children:e.role}),(0,a.jsx)("td",{className:"p-4 text-secondary-600",children:e.phone}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:()=>D(e),className:"p-1 text-secondary-600 hover:text-primary-600",children:(0,a.jsx)(l.A,{})}),(0,a.jsx)("button",{onClick:()=>M(e),className:"p-1 text-secondary-600 hover:text-red-600",children:(0,a.jsx)(o.A,{})})]})})]},e.id))})]})}),(0,a.jsx)(d.A,{open:C,onClose:I,maxWidth:"sm",fullWidth:!0,children:(0,a.jsxs)("form",{onSubmit:G,children:[(0,a.jsxs)(m.A,{className:"flex justify-between items-center",children:[E?"Edit User":"Add New User",(0,a.jsx)("button",{type:"button",onClick:I,className:"text-secondary-500 hover:text-secondary-700",children:(0,a.jsx)(i.A,{})})]}),(0,a.jsxs)(u.A,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Name"}),(0,a.jsx)("input",{type:"text",name:"name",value:F.name,onChange:B,className:"input-field w-full",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",name:"email",value:F.email,...E?{disabled:!0}:{},onChange:B,className:"input-field w-full",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Phone"}),(0,a.jsx)("input",{type:"tel",name:"phone",value:F.phone,onChange:B,className:"input-field w-full",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Role"}),(0,a.jsx)("select",{name:"role",value:F.role,onChange:B,className:"input-field w-full",required:!0,children:[{role:"superadmin"},{role:"admin"},{role:"subadmin"},{role:"blogger"},{role:"user"}].map((e,t)=>(0,a.jsx)("option",{value:e.role,children:e.role},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Password"}),(0,a.jsx)("input",{type:"password",name:"password",value:F.password,onChange:B,className:"input-field w-full",...E?{}:{required:!0}})]})]}),(0,a.jsxs)(h.A,{className:"p-4",children:[(0,a.jsx)("button",{type:"button",onClick:I,className:"btn-secondary",children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",className:"btn-primary flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"w-5 h-5"}),E?"Save Changes":"Add User"]})]})]})}),(0,a.jsx)(x.A,{open:!!S,title:"Delete User",message:'Are you sure you want to delete "'.concat(null==S?void 0:S.name,'"? This action cannot be undone.'),confirmLabel:v("deleteUser")?"Deleting...":"Delete",confirmVariant:"error",onConfirm:_,onCancel:()=>{P(null)},disabled:v("deleteUser")})]})})}},78477:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(95155),r=s(55088);function n(e){let{open:t,onConfirm:s,onCancel:n,title:l,message:o,confirmLabel:i="Confirm",confirmVariant:c="primary",disabled:d=!1}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6 m-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 text-red-600 mb-4",children:[(0,a.jsx)(r.A,{className:"w-6 h-6"}),(0,a.jsx)("h2",{className:"text-lg font-semibold",children:l})]}),(0,a.jsx)("p",{className:"text-secondary-600 mb-6",children:o}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:n,className:"px-4 py-2 text-secondary-700 hover:bg-secondary-50 rounded-lg transition-colors",disabled:d,children:"Cancel"}),(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 rounded-lg transition-colors ".concat((()=>{switch(c){case"error":return"bg-red-600 text-white hover:bg-red-700";case"warning":return"bg-yellow-600 text-white hover:bg-yellow-700";default:return"bg-primary-600 text-white hover:bg-primary-700"}})()," ").concat(d?"opacity-50 cursor-not-allowed":""),disabled:d,children:i})]})]})}):null}},97908:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(95155);function r(){return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[200px]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})})}},38258:(e,t,s)=>{"use strict";s.d(t,{M:()=>c,o:()=>d});var a=s(95155),r=s(12115),n=s(44522),l=s(7743),o=s(10810);let i=(0,r.createContext)(),c=()=>{let e=(0,r.useContext)(i);if(!e)throw Error("useLoading must be used within a LoadingProvider");return e},d=e=>{let{children:t}=e,[s,c]=(0,r.useState)({}),[d,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)("");return(0,a.jsxs)(i.Provider,{value:{setLoading:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";c(s=>({...s,[e]:t})),t&&s&&h(s)},isLoading:e=>s[e]||!1,showGlobalLoading:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...";h(e),m(!0)},hideGlobalLoading:()=>{m(!1),h("")},hasAnyLoading:()=>d||Object.values(s).some(e=>e),globalLoading:d},children:[t,(0,a.jsxs)(n.A,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1,backgroundColor:"rgba(0, 0, 0, 0.7)",flexDirection:"column",gap:2},open:d,children:[(0,a.jsx)(l.A,{color:"inherit",size:60}),u&&(0,a.jsx)(o.A,{variant:"h6",component:"div",children:u})]})]})}},8077:(e,t,s)=>{"use strict";s.d(t,{h:()=>i,p:()=>d});var a=s(95155),r=s(58803),n=s.n(r),l=s(12115);let o=(0,l.createContext)(),i=()=>{let e=(0,l.useContext)(o);if(!e)throw Error("useNotification must be used within a NotificationProvider");return e},c=e=>{let{notification:t,onRemove:s}=e;return(0,l.useEffect)(()=>{if(t.autoHide){let e=setTimeout(()=>{s(t.id)},t.duration);return()=>clearTimeout(e)}},[t,s]),(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 mb-3 rounded-lg shadow-lg min-w-[300px] max-w-[400px] border-l-4 transform transition-all duration-300",style:{animation:"slideIn 0.3s ease-out",...(e=>{switch(e){case"success":return{backgroundColor:"#10B981",color:"white",borderLeftColor:"#059669"};case"error":return{backgroundColor:"#EF4444",color:"white",borderLeftColor:"#DC2626"};case"warning":return{backgroundColor:"#F59E0B",color:"white",borderLeftColor:"#D97706"};case"info":return{backgroundColor:"#3B82F6",color:"white",borderLeftColor:"#2563EB"};default:return{backgroundColor:"#6B7280",color:"white",borderLeftColor:"#4B5563"}}})(t.type)},children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-xl mr-3 font-bold",children:(e=>{switch(e){case"success":return"✓";case"error":return"✕";case"warning":return"⚠";case"info":return"ℹ";default:return"•"}})(t.type)}),(0,a.jsx)("span",{className:"text-sm font-medium",children:t.message})]}),(0,a.jsx)("button",{onClick:()=>s(t.id),className:"ml-4 text-white hover:text-gray-200 font-bold text-lg",children:"\xd7"})]})},d=e=>{let{children:t}=e,[s,r]=(0,l.useState)([]),i=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3,n=Date.now()+Math.random(),l={id:n,message:e,type:t,autoHide:s,duration:a};return r(e=>[...e,l]),n},[]),d=(0,l.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e))},[]),m=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i(e,"success",t,5e3)},[i]),u=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i(e,"error",t,7e3)},[i]),h=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i(e,"warning",t,6e3)},[i]),x=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i(e,"info",t,4e3)},[i]),f=(0,l.useCallback)(()=>{m("Test notification is working!")},[m]),p=(0,l.useCallback)(()=>({addNotification:i,removeNotification:d,showSuccess:m,showError:u,showWarning:h,showInfo:x,testNotification:f}),[i,d,m,u,h,x,f]);return(0,a.jsxs)(o.Provider,{value:p(),children:[t,(0,a.jsx)("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:999999,pointerEvents:"none"},className:"jsx-5de7ed1ad044b70b",children:(0,a.jsx)("div",{style:{pointerEvents:"auto"},className:"jsx-5de7ed1ad044b70b",children:s.map(e=>(0,a.jsx)(c,{notification:e,onRemove:d},e.id))})}),(0,a.jsx)(n(),{id:"5de7ed1ad044b70b",children:"@-webkit-keyframes slideIn{from{-webkit-transform:translatex(100%);transform:translatex(100%);opacity:0}to{-webkit-transform:translatex(0);transform:translatex(0);opacity:1}}@-moz-keyframes slideIn{from{-moz-transform:translatex(100%);transform:translatex(100%);opacity:0}to{-moz-transform:translatex(0);transform:translatex(0);opacity:1}}@-o-keyframes slideIn{from{-o-transform:translatex(100%);transform:translatex(100%);opacity:0}to{-o-transform:translatex(0);transform:translatex(0);opacity:1}}@keyframes slideIn{from{-webkit-transform:translatex(100%);-moz-transform:translatex(100%);-o-transform:translatex(100%);transform:translatex(100%);opacity:0}to{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0);opacity:1}}"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2983,401,2405,8441,1517,7358],()=>t(35804)),_N_E=e.O()}]);