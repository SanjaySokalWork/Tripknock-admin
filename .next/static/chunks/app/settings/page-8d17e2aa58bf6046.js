(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4662],{16184:(e,s,t)=>{Promise.resolve().then(t.bind(t,74101))},6327:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});var a=t(12983),n=t(95155);let r=(0,a.A)((0,n.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},6748:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});var a=t(12983),n=t(95155);let r=(0,a.A)((0,n.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},76046:(e,s,t)=>{"use strict";var a=t(66658);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},36228:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});var a=t(95155),n=t(97908);function r(){return(0,a.jsx)(n.A,{})}},74101:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(95155),n=t(12115),r=t(6748),i=t(6327),l=t(34854),o=t(36228);function d(){let{user:e,isLoggedIn:s}=(0,l.U)(),[t,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!1),[m,p]=(0,n.useState)(!1),[h,x]=(0,n.useState)(!1),[f,j]=(0,n.useState)(!1),[w,b]=(0,n.useState)({id:"",name:"",email:"",phone:""});(0,n.useEffect)(()=>{document.title="Settings - Tripknock",!0===s&&b({id:e.id,name:e.name,email:e.email,phone:e.phone})},[e]);let[v,g]=(0,n.useState)({password:"",newPassword:"",confirmPassword:""}),N=e=>{g(s=>({...s,[e.target.name]:e.target.value}))},y=e=>{let{name:s,value:t,type:a,checked:n}=e.target;b(e=>({...e,[s]:"checkbox"===a?n:t}))},C=async e=>{e.preventDefault(),d(!0);let s=await fetch("https://data.tripknock.in/user/profile/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:w.id,name:w.name,phone:w.phone})});!0===(await s.json()).status?(j(!0),x(!1)):(x(!0),j(!1)),d(!1)},P=async e=>{if(e.preventDefault(),d(!0),v.newPassword!==v.confirmPassword)u(!0),d(!1),x(!1),p(!1);else{let e=await fetch("https://data.tripknock.in/user/profile/update-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:w.id,oldPassword:v.password,newPassword:v.newPassword})});!0===(await e.json()).status?(u(!1),x(!1),p(!0),g({password:"",newPassword:"",confirmPassword:""})):(u(!0),x(!1),p(!1)),d(!1)}};return t?(0,a.jsx)(o.A,{}):(0,a.jsx)(a.Fragment,{children:!0===t?(0,a.jsx)(o.A,{}):(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsx)("h1",{className:"text-2xl font-bold text-secondary-900",children:"Settings"})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Profile Settings"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Name"}),(0,a.jsx)("input",{type:"text",name:"name",className:"input-field",placeholder:"Your name",value:w.name,onChange:y})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",name:"email",className:"input-field",placeholder:"Your email",value:w.email,disabled:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Phone"}),(0,a.jsx)("input",{type:"tel",name:"phone",className:"input-field",placeholder:"Your phone number",value:w.phone,onChange:y})]}),(0,a.jsx)("div",{className:"col-span-full flex justify-end mt-6",children:(0,a.jsxs)("button",{onClick:C,className:"btn-primary flex items-center gap-2",children:[(0,a.jsx)(r.A,{className:"w-5 h-5"}),"Save Changes"]})}),h&&(0,a.jsxs)("div",{className:"px-5 py-4 bg-red-200 rounded-xl flex justify-between",children:[(0,a.jsx)("p",{className:"text-red-700",children:"Error in Updating Profile"}),(0,a.jsx)("button",{onClick:()=>x(!1),children:(0,a.jsx)(i.A,{className:"w-5 h-5 text-red-700"})})]}),f&&(0,a.jsxs)("div",{className:"px-5 py-4 bg-green-200 rounded-xl flex justify-between",children:[(0,a.jsx)("p",{className:"text-green-700",children:"Profile Updated"}),(0,a.jsx)("button",{onClick:()=>j(!1),children:(0,a.jsx)(i.A,{className:"w-5 h-5 text-green-700"})})]})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Password Settings"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Current Password"}),(0,a.jsx)("input",{type:"password",name:"password",className:"input-field",value:v.password,onChange:N,placeholder:"Enter current password"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"New Password"}),(0,a.jsx)("input",{type:"password",className:"input-field",name:"newPassword",value:v.newPassword,onChange:N,placeholder:"Enter new password"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Confirm New Password"}),(0,a.jsx)("input",{type:"password",name:"confirmPassword",className:"input-field",value:v.confirmPassword,onChange:N,placeholder:"Confirm new password"})]}),(0,a.jsx)("div",{className:"col-span-full flex justify-end mt-6",children:(0,a.jsxs)("button",{onClick:P,className:"btn-primary flex items-center gap-2",children:[(0,a.jsx)(r.A,{className:"w-5 h-5"}),"Save Changes"]})}),c&&(0,a.jsxs)("div",{className:"px-5 py-4 bg-red-200 rounded-xl flex justify-between",children:[(0,a.jsx)("p",{className:"text-red-700",children:"Passwords do not match"}),(0,a.jsx)("button",{onClick:()=>u(!1),children:(0,a.jsx)(i.A,{className:"w-5 h-5 text-red-700"})})]}),m&&(0,a.jsxs)("div",{className:"px-5 py-4 bg-green-200 rounded-xl flex justify-between",children:[(0,a.jsx)("p",{className:"text-green-700",children:"Password Updated"}),(0,a.jsx)("button",{onClick:()=>p(!1),children:(0,a.jsx)(i.A,{className:"w-5 h-5 text-green-700"})})]})]})]})]})]})})}},97908:(e,s,t)=>{"use strict";t.d(s,{A:()=>n});var a=t(95155);function n(){return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[200px]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})})}},34854:(e,s,t)=>{"use strict";t.d(s,{D:()=>o,U:()=>d});var a=t(95155),n=t(12115),r=t(89208),i=t(76046);let l=(0,n.createContext)(),o=e=>{let{children:s}=e,t=(0,i.useRouter)(),o=(0,i.usePathname)(),[d,c]=(0,n.useState)(!1),[u,m]=(0,n.useState)({id:"",email:"",name:"",role:"",phone:""});return(0,n.useEffect)(()=>{let e=r.A.get("tk_auth_details");if(null!=e){let s=JSON.parse(e);(async()=>{let e=await fetch("https://data.tripknock.in/user/verify",{method:"POST",headers:{"Content-Type":"application/json",admin:s.email},body:JSON.stringify({id:s.id,email:s.email})}),a=await e.json();!1===a.status?(c(!1),t.push("/login"),m({})):(m(a),c(!0))})()}else m({}),c(!1),t.push("/login")},[o]),(0,a.jsx)(l.Provider,{value:{user:u,isLoggedIn:d,login:e=>{m(e),c(!0)},logout:()=>{m(null),c(!1)}},children:s})},d=()=>(0,n.useContext)(l)},89208:(e,s,t)=>{"use strict";function a(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var a in t)e[a]=t[a]}return e}t.d(s,{A:()=>n});var n=function e(s,t){function n(e,n,r){if("undefined"!=typeof document){"number"==typeof(r=a({},t,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var l in r)r[l]&&(i+="; "+l,!0!==r[l]&&(i+="="+r[l].split(";")[0]));return document.cookie=e+"="+s.write(n,e)+i}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],a={},n=0;n<t.length;n++){var r=t[n].split("="),i=r.slice(1).join("=");try{var l=decodeURIComponent(r[0]);if(a[l]=s.read(i,l),e===l)break}catch(e){}}return e?a[e]:a}},remove:function(e,s){n(e,"",a({},s,{expires:-1}))},withAttributes:function(s){return e(this.converter,a({},this.attributes,s))},withConverter:function(s){return e(a({},this.converter,s),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(s)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}},e=>{var s=s=>e(e.s=s);e.O(0,[2983,8441,1517,7358],()=>s(16184)),_N_E=e.O()}]);